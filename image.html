<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>PNG Image ‚Äì Free Download</title>
  <meta name="description" content="Download PNG image with transparent background for free." />

  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/image.css" />
  <link rel="stylesheet" href="css/search.css" />
  <link rel="canonical" id="canonicalLink" href="" />

  <meta property="og:type" content="website">
  <meta property="og:title" content="Free Transparent PNG Image Download">
  <meta property="og:description" content="Download high-quality PNG with transparent background.">
  <meta name="twitter:card" content="summary_large_image">

</head>

<body>

  <!-- HEADER -->
  <header class="search-header">
    <div class="search-header-inner">

      <div class="logo">
        <a href="index.html">
          <img src="images/logo2.png" alt="PNGfam">
        </a>
      </div>

      <div class="search-box right-search">
        <input type="text" id="searchInput" placeholder="Search PNG images..." />
        <span class="search-icon">
          <img src="images/search.png" alt="Search">
        </span>
      </div>

    </div>
  </header>

  <!-- IMAGE PAGE -->
  <section class="image-wrapper">

    <div class="image-card">

      <div class="image-preview">
        <img id="mainPreview" src="" alt="">
      </div>

      <div class="title-row">
        <h1>Loading...</h1>
        <button class="info-btn" id="infoBtn">‚ÑπÔ∏è</button>
      </div>

      <div class="tags"></div>

      <!-- SEO DESCRIPTION BLOCK -->
      <div class="image-seo-text">
        <p id="seoText">
          Download high-quality PNG image with transparent background. Free for
          personal and commercial use. Perfect for graphic design, ads, UI design,
          presentations, and creative projects.
        </p>

        <ul class="feature-list">
          <li>‚úî Transparent background PNG</li>
          <li>‚úî Free for personal & commercial use</li>
          <li>‚úî High resolution quality</li>
          <li>‚úî No attribution required</li>
        </ul>
      </div>

      <a class="download-btn" href="#" download>
        <img src="images/download.png" alt="Download">
        <span>Download PNG</span>
      </a>

    </div>

  </section>

  <!-- RELATED IMAGES -->
  <section class="related-section">
    <h2>Related PNG Images</h2>

    <div class="container">
      <div class="grid">
        <div class="card skeleton"></div>
        <div class="card skeleton"></div>
        <div class="card skeleton"></div>
        <div class="card skeleton"></div>
      </div>
    </div>
  </section>

  <!-- INFO MODAL -->
  <div class="info-modal" id="infoModal">
    <div class="info-content">
      <button class="close-icon" id="closeInfo">‚úï</button>
      <h3>Image Details</h3>
      <p>Background: Transparent</p>
      <p>License: Free for personal & commercial use</p>
    </div>
  </div>
  
  <footer class="site-footer">
    <div class="footer-inner">
      <nav class="footer-links">
        <a href="/privacy-policy">Privacy Policy</a>
        <a href="/terms">Terms</a>
        <a href="/dmca">DMCA</a>
        <a href="/license">License</a>
        <a href="/contact">Contact</a>
      </nav>
      <p class="footer-copy">¬© 2026 PNGfam ‚Äî Free Transparent PNG Images</p>
    </div>
  </footer>

</body>
<script>

const API = "https://pngfam-backend.onrender.com";

document.addEventListener("DOMContentLoaded", () => {

  const searchInput = document.getElementById("searchInput");
  const searchIcon = document.querySelector(".search-icon");

  if (!searchInput) return;

  function doSearch() {
    const query = searchInput.value.trim();
    if (!query) return;

    // ‚úÖ CORRECT ROUTE (same as home & search page)
    window.location.href = `/search?q=${encodeURIComponent(query)}`;
  }

  searchInput.addEventListener("keydown", e => {
    if (e.key === "Enter") doSearch();
  });

  if (searchIcon) {
    searchIcon.addEventListener("click", doSearch);
  }

});
</script>

<!-- INFO MODAL -->
<script>
  const infoBtn = document.getElementById('infoBtn');
  const infoModal = document.getElementById('infoModal');
  const closeIcon = document.getElementById('closeInfo');

  if (infoBtn) {
    infoBtn.onclick = () => infoModal.style.display = 'flex';
    closeIcon.onclick = () => infoModal.style.display = 'none';
    infoModal.onclick = e => {
      if (e.target === infoModal) infoModal.style.display = 'none';
    };
  }
</script>

<!-- MAIN IMAGE LOAD -->
<script>
  const slug = window.location.pathname.split("/image/")[1];

  if (!slug) {
    window.location.href = "index.html";
  } else {

    fetch(`${API}/api/pngs/${slug}`)
      .then(res => {
        if (!res.ok) throw new Error("Not found");
        return res.json();
      })
      .then(png => {

        /* üî• USE PREVIEW / WEBP IMAGE */
        const img = document.getElementById("mainPreview");
        
        document.querySelector(".title-row h1").innerText = png.title;

        /* üî• MAIN IMAGE SHOULD USE PREVIEW WEBP */
        img.src = png.previewUrl || png.originalUrl;
        img.alt = `${png.title} transparent png`;
        img.loading = "eager";
        img.decoding = "async";

        const downloadBtn = document.querySelector(".download-btn");

        downloadBtn.href = `${API}/api/pngs/${png.slug}/download`;
        downloadBtn.removeAttribute("download"); // important

        downloadBtn.querySelector("span").innerText =
          `Download PNG (${png.width} √ó ${png.height})`;

        /* Tags */
        const tagsBox = document.querySelector(".tags");
        tagsBox.innerHTML = "";
        (png.tags || []).forEach(tag => {
          const span = document.createElement("span");
          span.innerText = tag;
          tagsBox.appendChild(span);
        });

        /* SEO */
          const seoDescription = `Download ${png.title} PNG with transparent background. 
          Free HD cutout image for graphic design, ads, posters, websites and creative projects. 
          No attribution required.`;

          /* Title */
          document.title = `${png.title} ‚Äì Free Transparent PNG Download`;

          /* Canonical URL */
          const canonical = document.getElementById("canonicalLink");
          if (canonical) {
            canonical.href = `${window.location.origin}/image/${png.slug}`;
          }

          /* Meta Description */
          document
            .querySelector('meta[name="description"]')
            .setAttribute("content", seoDescription);

          /* Visible SEO Text */
          const seoText = document.getElementById("seoText");
          if (seoText) seoText.innerText = seoDescription;

          /* ================= IMAGE SCHEMA (JSON-LD) ================= */

          const schema = {
            "@context": "https://schema.org",
            "@type": "ImageObject",
            "name": png.title,
            "description": png.description || `Download ${png.title} PNG with transparent background`,
            "contentUrl": png.originalUrl,
            "thumbnailUrl": png.previewUrl || png.thumbUrl,
            "width": png.width,
            "height": png.height,
            "fileFormat": "image/png",
            "license": "https://www.pngfam.com/license",
            "acquireLicensePage": "https://www.pngfam.com/license",
            "url": `${window.location.origin}/image/${png.slug}`,
            "author": {
              "@type": "Organization",
              "name": "PNGfam"
            }
          };

          /* Inject schema */
          let scriptTag = document.querySelector("#image-schema");
          if (!scriptTag) {
            scriptTag = document.createElement("script");
            scriptTag.type = "application/ld+json";
            scriptTag.id = "image-schema";
            document.head.appendChild(scriptTag);
          }

          scriptTag.textContent = JSON.stringify(schema);

          /* OG IMAGE */
          let ogImage = document.querySelector('meta[property="og:image"]');
          if (!ogImage) {
            ogImage = document.createElement("meta");
            ogImage.setAttribute("property", "og:image");
            document.head.appendChild(ogImage);
          }
          ogImage.setAttribute("content", png.previewUrl || png.thumbUrl);

          /* OG IMAGE WIDTH & HEIGHT */
          let ogWidth = document.querySelector('meta[property="og:image:width"]');
          if (!ogWidth) {
            ogWidth = document.createElement("meta");
            ogWidth.setAttribute("property", "og:image:width");
            document.head.appendChild(ogWidth);
          }
          ogWidth.setAttribute("content", png.width);

          let ogHeight = document.querySelector('meta[property="og:image:height"]');
          if (!ogHeight) {
            ogHeight = document.createElement("meta");
            ogHeight.setAttribute("property", "og:image:height");
            document.head.appendChild(ogHeight);
          }
          ogHeight.setAttribute("content", png.height);

          let linkImageSrc = document.querySelector('link[rel="image_src"]');
          if (!linkImageSrc) {
            linkImageSrc = document.createElement("link");
            linkImageSrc.setAttribute("rel", "image_src");
            document.head.appendChild(linkImageSrc);
          }
          linkImageSrc.setAttribute("href", png.previewUrl || png.thumbUrl);

          /* Twitter */
          let twitterImage = document.querySelector('meta[name="twitter:image"]');
          if (!twitterImage) {
            twitterImage = document.createElement("meta");
            twitterImage.setAttribute("name", "twitter:image");
            document.head.appendChild(twitterImage);
          }
          twitterImage.setAttribute("content", png.previewUrl || png.thumbUrl);

          const preload = document.createElement("link");
          preload.rel = "preload";
          preload.as = "image";
          preload.href = png.previewUrl || png.thumbUrl;
          document.head.appendChild(preload);
            
      })
      .catch(() => {
        document.querySelector(".image-wrapper").innerHTML =
          "<p>Failed to load image</p>";
      });

  }
</script>


<!-- RELATED IMAGES (SAFE FALLBACK) -->
<script>
  const slug2 = window.location.pathname.split("/image/")[1];

  if (slug2) {
    fetch(`${API}/api/pngs`)
      .then(res => res.json())
      .then(data => {
        const grid = document.querySelector(".related-section .grid");
        grid.innerHTML = "";

        data
          .filter(p => p.slug !== slug2)
          .slice(0, 6)
          .forEach(png => {
            const card = document.createElement("div");
            card.className = "card";

            card.innerHTML = `
              <div class="card-image">
                <img src="${png.thumbUrl}" alt="${png.title}">
              </div>
              <p class="card-title">${png.title}</p>
            `;

            card.onclick = () => {
              window.location.href = `/image/${png.slug}`;
            };

            grid.appendChild(card);
          });
      });
  }
</script>

